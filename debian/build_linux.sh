#!/bin/bash

cd ..

git reset --hard
git clean -d -f -x -e build-number.txt

./bootstrap
./configure
make clean
rm *.deb

make -j8
if [ "$?" -ne "0" ]; then
  echo "***************************************************************************************************"
  echo "make failed."
  echo "***************************************************************************************************"
  exit 1
fi

make release
if [ "$?" -ne "0" ]; then
  echo "***************************************************************************************************"
  echo "make release failed."
  echo "***************************************************************************************************"
  exit 2
fi
make -C tools/TexturePacker -f Makefile.host
if [ "$?" -ne "0" ]; then
  echo "***************************************************************************************************"
  echo "make TexturePacker failed."
  echo "***************************************************************************************************"
  exit 3
fi
make -C skin/boxee/media
if [ "$?" -ne "0" ]; then
  echo "***************************************************************************************************"
  echo "make textures failed."
  echo "***************************************************************************************************"
  exit 4
fi

cd debian

sudo ./make_debian.sh
if [ "$?" -ne "0" ]; then
  echo "***************************************************************************************************"
  echo "DEB creation failed."
  echo "***************************************************************************************************"
  exit 5
fi

